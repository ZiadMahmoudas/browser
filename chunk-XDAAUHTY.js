import{a as m}from"./chunk-XDVOVM47.js";import{p as f}from"./chunk-RDDNRQB3.js";import{V as i,Y as b,aa as h,ba as l,l as p,t as u}from"./chunk-G3DW5CM7.js";var y=class s{constructor(e){this.http=e}baseURL=l(m);cartSubject=new p([]);cart$=this.cartSubject.asObservable();loadCart(e){return this.http.get(`${this.baseURL}Cart/${e}`).pipe(i(t=>{this.cartSubject.next(t)}))}addToCart(e,t,r){let a={userId:e,productId:t,quantity:r};return this.http.post(`${this.baseURL}Cart/add`,a).pipe(i(n=>{let c=this.cartSubject.getValue(),o=c.findIndex(C=>C.cartId===n.cartId);o!==-1?c[o].quantity+=r:c.push(n),this.cartSubject.next([...c])}))}removeFromCart(e){return this.http.delete(`${this.baseURL}Cart/${e}`).pipe(i(t=>{let r=this.cartSubject.getValue(),a=r.findIndex(n=>n.cartId===e);a!==-1&&(t&&typeof t.quantity=="number"?t.quantity>0?r[a].quantity=t.quantity:r.splice(a,1):(r[a].quantity-=1,r[a].quantity<=0&&r.splice(a,1)),this.cartSubject.next([...r]))}))}totalPrice$=this.cart$.pipe(u(e=>e.reduce((t,r)=>t+r.salary*r.quantity,0)));getCartItemCount(){return this.cartSubject.value.reduce((e,t)=>e+t.quantity,0)}cartCount$=this.cart$.pipe(u(e=>e.reduce((t,r)=>t+r.quantity,0)));loadCartFromServer(e){return this.http.get(`${this.baseURL}Cart/${e}`).pipe(i(t=>{this.cartSubject.next(t)}))}clearCartLocal(){this.cartSubject.next([])}static \u0275fac=function(t){return new(t||s)(h(f))};static \u0275prov=b({token:s,factory:s.\u0275fac,providedIn:"root"})};export{y as a};
