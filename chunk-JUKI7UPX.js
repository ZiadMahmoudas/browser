import{a as p}from"./chunk-KXU7AWJN.js";import{a as l}from"./chunk-XDVOVM47.js";import{p as m}from"./chunk-RDDNRQB3.js";import{T as i,V as h,Y as a,aa as r,ba as c,l as o}from"./chunk-G3DW5CM7.js";var u=class e{constructor(t,s){this.http=t;this.storage=s}baseURL=c(l);currentUserId=null;wishlistItemsSubject=new o([]);wishlistItems$=this.wishlistItemsSubject.asObservable();setCurrentUserId(t){this.currentUserId=t}fetchAndStoreWishlist(t){return this.setCurrentUserId(t),this.http.get(`${this.baseURL}WishList/${t}`).pipe(h(s=>{this.saveWishlistItems(s),this.wishlistItemsSubject.next(s)}))}addToWishlist(t){return this.http.post(`${this.baseURL}WishList/add`,t).pipe(i(()=>{if(!this.currentUserId)throw new Error("UserId not set");return this.fetchAndStoreWishlist(this.currentUserId)}))}removeFromWishlist(t){return this.http.delete(`${this.baseURL}WishList/${t}`).pipe(i(()=>{if(!this.currentUserId)throw new Error("UserId not set");return this.fetchAndStoreWishlist(this.currentUserId)}))}saveWishlistItems(t){let s=t.map(n=>n.wishListId??n.wishlistId);this.storage.set("WishList",JSON.stringify(s)),this.wishlistItemsSubject.next(s)}getWishlistItemsFromStorage(){let t=this.storage.get("WishList");if(t)try{return JSON.parse(t)}catch(s){console.error("Invalid wishlist data in localStorage",s)}return[]}loadWishlistFromStorage(){let t=this.getWishlistItemsFromStorage();this.wishlistItemsSubject.next(t)}clearWishlist(){this.storage.remove("WishList"),this.wishlistItemsSubject.next([])}static \u0275fac=function(s){return new(s||e)(r(m),r(p))};static \u0275prov=a({token:e,factory:e.\u0275fac,providedIn:"root"})};export{u as a};
