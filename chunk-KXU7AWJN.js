import{a as l,b as u}from"./chunk-XDVOVM47.js";import{n as h,o as p,p as g}from"./chunk-RDDNRQB3.js";import{Y as i,aa as n,ba as c,h as o}from"./chunk-G3DW5CM7.js";var a=class r{constructor(e){this.storage=e}accessTokenKey="accessToken";setAccessToken(e){localStorage.setItem(this.accessTokenKey,e)}getAccessToken(){return localStorage.getItem(this.accessTokenKey)}clearAccessToken(){localStorage.removeItem(this.accessTokenKey)}get(e){return this.storage.getItem(e)}set(e,t){this.storage.setItem(e,t)}remove(e){this.storage.removeItem(e)}static \u0275fac=function(t){return new(t||r)(n(u))};static \u0275prov=i({token:r,factory:r.\u0275fac,providedIn:"root"})};var k=class r{constructor(e,t){this.http=e;this.tokenService=t}baseURL=c(l);login(e){return new o(t=>{this.http.post(`${this.baseURL}Auth/login`,e,{withCredentials:!0}).subscribe({next:s=>{this.tokenService.setAccessToken(s.accessToken),t.next(s),t.complete()},error:s=>{t.error(s)}})})}signup(e){return new o(t=>{this.http.post(`${this.baseURL}Auth/register`,e,{withCredentials:!0}).subscribe({next:s=>{this.tokenService.setAccessToken(s.accessToken),t.next(s)},error:s=>{t.error(s)}})})}refreshToken(){return new o(e=>{this.http.post(`${this.baseURL}Auth/refresh`,{},{withCredentials:!0}).subscribe({next:t=>{this.tokenService.setAccessToken(t.accessToken),e.next(t.accessToken),e.complete()},error:t=>{e.error(t)}})})}saveNewTokens(e){this.tokenService.setAccessToken(e.accessToken)}getAccessToken(){return this.tokenService.getAccessToken()}removeAccessToken(){this.tokenService.clearAccessToken()}logout(){return this.http.post(`${this.baseURL}Auth/logout`,{},{withCredentials:!0,headers:new h({Authorization:"Bearer "+this.tokenService.getAccessToken()})})}handleCredentialResponse(e){let t=e.credential;return this.http.post(`${this.baseURL}Auth/GoogleResponse`,{idToken:t,provider:"Google"},{withCredentials:!0})}loginWithGoogle(e,t){return this.http.post(`${this.baseURL}ExternalAuth/signin-google`,{idToken:e,recaptchaToken:t},{withCredentials:!0})}loginWithFacebook(e,t){return this.http.post(`${this.baseURL}ExternalAuth/signin-facebook`,{idToken:e,recaptchaToken:t},{withCredentials:!0})}forgetPassword(e){return this.http.post(`${this.baseURL}Forget/forget-password`,e,{withCredentials:!0,responseType:"text"})}submitNewPassword(e){return this.http.post(`${this.baseURL}Forget/submit-new-password`,e,{withCredentials:!0,responseType:"text"})}confirmPasswordChange(e,t){let s=new p().set("token",e).set("action",t);return this.http.get(`${this.baseURL}Forget/confirm-password-change`,{params:s,withCredentials:!0})}static \u0275fac=function(t){return new(t||r)(n(g),n(a))};static \u0275prov=i({token:r,factory:r.\u0275fac,providedIn:"root"})};export{a,k as b};
