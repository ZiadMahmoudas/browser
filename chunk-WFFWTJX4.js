import{a as N,b as c,c as F,d as C,i as D,j as O,k,l as V,m as A,n as q,o as G,s as U,u as j}from"./chunk-MHH2VTG2.js";import{a as B}from"./chunk-L7DWKR3J.js";import{b as I}from"./chunk-C345KUIT.js";import{n as $}from"./chunk-XDVOVM47.js";import{e as x,j as E}from"./chunk-RDDNRQB3.js";import{Eb as w,Jb as u,Lb as v,Ta as l,Wb as o,Xb as y,Yb as f,Za as g,cb as S,ha as b,hb as T,ia as h,tb as _,ub as P,vb as m,wb as a,xb as r,yb as d}from"./chunk-G3DW5CM7.js";var R=(s,e)=>e.id;function Q(s,e){if(s&1&&(a(0,"option"),o(1),r()),s&2){let i=e.$implicit;l(),y(i.tagId)}}function z(s,e){if(s&1&&(a(0,"option",31),o(1),r()),s&2){let i=e.$implicit;m("value",i.id),l(),y(i.title)}}function H(s,e){if(s&1){let i=w();a(0,"li",51),o(1),a(2,"div")(3,"button",52),u("click",function(){let n=b(i).$implicit,p=v();return h(p.selectTagForUpdate(n))}),o(4,"Edit"),r(),a(5,"button",53),u("click",function(){let n=b(i).$implicit,p=v();return h(p.deleteTag(n.tagId))}),o(6,"Delete"),r()()()}if(s&2){let i=e.$implicit;l(),f(" ",i.tagType," ")}}var M=class s{constructor(e,i,t,n){this.toastr=e;this.dashboardServices=i;this.fb=t;this.route=n}addProduct;addTag;updateTag;isEdit=!1;editProductId=null;allTags=[];allOffers=[];selectedImage=null;ngOnInit(){this.initForms(),this.loadTags(),this.loadOffers();let e=this.route.snapshot.params.id;e&&(this.isEdit=!0,this.editProductId=+e,this.loadProduct(this.editProductId))}initForms(){this.addProduct=this.fb.group({productName:["",c.required],productDescription:["",c.required],salary:[0,[c.required,c.min(0)]],stock:[0,[c.required,c.min(0)]],brand:["",c.required],tagType:["",c.required],offer:[""],images:[null]}),this.addTag=this.fb.group({tagType:["",c.required]}),this.updateTag=this.fb.group({tagType:["",c.required]})}originalTagType="";selectTagForUpdate(e){this.selectedTagId=e.tagId,this.originalTagType=e.tagType,this.updateTag.patchValue({tagType:e.tagType})}onupdateTag(){if(!this.selectedTagId){this.toastr.error("Please select a tag to update");return}if(this.updateTag.invalid){this.toastr.warning("Please enter a tag name");return}let e=this.updateTag.value.tagType.trim();if(e===this.originalTagType)return;let i={tagType:e};this.dashboardServices.updateTag(i,this.selectedTagId).subscribe({next:()=>{this.toastr.success("Tag updated successfully"),this.loadTags(),this.updateTag.reset(),this.selectedTagId=null,this.originalTagType=""},error:t=>{console.error(t),this.toastr.error(t.error?.message||"Failed to update tag")}})}loadProduct(e){this.dashboardServices.GetAllProduct().subscribe(i=>{let t=i.find(n=>n.id===e);t&&this.addProduct.patchValue({productName:t.productName,productDescription:t.productDescription,salary:t.salary,stock:t.stock,brand:t.brand,tagType:t.tagId,offer:t.offerId,images:t.images})})}loadTags(){this.dashboardServices.getAllTags().subscribe(e=>this.allTags=e)}loadOffers(){this.dashboardServices.getAllOffers().subscribe(e=>this.allOffers=e)}onImageChange(e){this.selectedImage=e.target.files[0]}selectedTagId=null;onTag(){if(this.addTag.invalid){this.toastr.warning("Please enter a tag name");return}let e={tagType:this.addTag.value.tagType};this.dashboardServices.CreateTag(e).subscribe({next:()=>{this.toastr.success("Tag added successfully"),this.addTag.reset(),this.loadTags()},error:i=>{console.error(i),this.toastr.error(i.error?.message||"Something went wrong")}})}deleteTag(e){confirm("\u0647\u0644 \u0623\u0646\u062A \u0645\u062A\u0623\u0643\u062F \u0645\u0646 \u062D\u0630\u0641 \u0647\u0630\u0627 \u0627\u0644\u062A\u0627\u062C\u061F")&&this.dashboardServices.DeleteTag(e).subscribe({next:()=>{this.toastr.success("Tag deleted successfully"),this.loadTags(),this.selectedTagId===e&&(this.updateTag.reset(),this.selectedTagId=null)},error:i=>{console.error(i),this.toastr.error(i.error?.message||"Something went wrong while deleting the tag")}})}onSubmit(){if(this.addProduct.invalid){this.toastr.warning("Please fill all required fields");return}let e=this.addProduct.value,i=Number(e.tagType);if(isNaN(i)||i<=0){this.toastr.error("Please select a valid Tag");return}let t=new FormData;if(t.append("productName",e.productName),t.append("productDescription",e.productDescription),t.append("salary",e.salary.toString()),t.append("stock",e.stock.toString()),t.append("brand",e.brand),t.append("tagId",i.toString()),e.offer&&t.append("offerId",e.offer.toString()),this.selectedImage)t.append("Image",this.selectedImage);else if(!this.isEdit){this.toastr.error("Please select an image");return}this.isEdit&&this.editProductId?this.dashboardServices.updateProduct(this.editProductId,t).subscribe({next:()=>{this.toastr.success("Product updated successfully")},error:n=>{this.toastr.error(n.error?.message||"Something went wrong")}}):this.dashboardServices.CreateProduct(t).subscribe({next:()=>{this.toastr.success("Product added successfully")},error:n=>{this.toastr.error(n.error?.message||"Something went wrong")}})}static \u0275fac=function(i){return new(i||s)(g($),g(B),g(U),g(I))};static \u0275cmp=S({type:s,selectors:[["app-product"]],decls:89,vars:10,consts:[[1,"container","my-5"],[1,"row","justify-content-center","g-4"],[1,"col-lg-7"],[1,"card","shadow-lg","border-0","rounded-lg"],[1,"card-header","bg-primary","text-white","text-center","py-4","rounded-top"],[1,"mb-0"],[1,"fas","fa-box-open","me-2"],[1,"card-body","p-4"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","productName",1,"form-label","fw-bold"],["type","text","id","productName","formControlName","productName","placeholder","Enter product name",1,"form-control","form-control-lg"],["for","productDescription",1,"form-label","fw-bold"],["id","productDescription","formControlName","productDescription","placeholder","Product Description","rows","4",1,"form-control"],[1,"row"],[1,"col-lg-6","mb-3"],["for","price",1,"form-label","fw-bold"],[1,"input-group"],[1,"input-group-text"],["type","number","id","price","formControlName","salary","placeholder","Price",1,"form-control","form-control-lg"],["for","quantity",1,"form-label","fw-bold"],["type","number","id","quantity","formControlName","stock","placeholder","Quantity",1,"form-control","form-control-lg"],["for","brand",1,"form-label","fw-bold"],["type","text","id","brand","formControlName","brand","placeholder","Brand Name",1,"form-control","form-control-lg"],["for","tag",1,"form-label","fw-bold"],["id","tag","formControlName","tagType",1,"form-select","form-select-lg"],["value","","disabled","","selected",""],[4,"ngFor","ngForOf"],["for","offer",1,"form-label","fw-bold"],["id","offer","formControlName","offer",1,"form-select","form-select-lg"],[3,"disabled","selected"],[3,"value"],[1,"mb-4"],["for","productImage",1,"form-label","fw-bold"],["type","file","id","productImage","accept","image/*",1,"form-control","form-control-lg",3,"change"],[1,"d-grid","gap-2"],["type","submit",1,"btn","btn-primary","btn-lg"],[1,"fas","fa-plus-circle","me-2"],[1,"col-lg-5"],[1,"card","shadow-lg","border-0","rounded-lg","my-4"],[1,"card-header","bg-success","text-white","text-center","py-4","rounded-top"],[1,"fas","fa-tags","me-2"],["for","tagName",1,"form-label","fw-bold"],["type","text","id","tagName","formControlName","tagType","placeholder","e.g., Electronics, Fashion, etc.",1,"form-control","form-control-lg"],["type","submit",1,"btn","btn-success","btn-lg"],[1,"fas","fa-plus","me-2"],[1,"card-header","bg-warning","text-white","text-center","py-4","rounded-top"],[1,"list-group","mb-3"],["type","submit",1,"btn","btn-secondary","btn-lg",3,"disabled"],[1,"fas","fa-edit","me-2"],["class","list-group-item d-flex justify-content-between align-items-center",4,"ngFor","ngForOf"],[1,"list-group-item","d-flex","justify-content-between","align-items-center"],[1,"btn","btn-sm","btn-warning","me-2",3,"click"],[1,"btn","btn-sm","btn-danger",3,"click"]],template:function(i,t){i&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h3",5),d(6,"i",6),o(7),r()(),a(8,"div",7)(9,"form",8),u("ngSubmit",function(){return t.onSubmit()}),a(10,"div",9)(11,"label",10),o(12,"Product Name"),r(),d(13,"input",11),r(),a(14,"div",9)(15,"label",12),o(16,"Description"),r(),d(17,"textarea",13),r(),a(18,"div",14)(19,"div",15)(20,"label",16),o(21,"Price"),r(),a(22,"div",17)(23,"span",18),o(24,"$"),r(),d(25,"input",19),r()(),a(26,"div",15)(27,"label",20),o(28,"Quantity"),r(),d(29,"input",21),r()(),a(30,"div",9)(31,"label",22),o(32,"Brand"),r(),d(33,"input",23),r(),a(34,"div",9)(35,"label",24),o(36,"Tag"),r(),a(37,"select",25)(38,"option",26),o(39,"-- Select Tag --"),r(),T(40,Q,2,1,"option",27),r()(),a(41,"div",9)(42,"label",28),o(43,"Offer"),r(),a(44,"select",29)(45,"option",30),o(46,"-- Select Offer --"),r(),_(47,z,2,2,"option",31,R),r()(),a(49,"div",32)(50,"label",33),o(51,"Product Image"),r(),a(52,"input",34),u("change",function(p){return t.onImageChange(p)}),r()(),a(53,"div",35)(54,"button",36),d(55,"i",37),o(56),r()()()()()(),a(57,"div",38)(58,"div",39)(59,"div",40)(60,"h3",5),d(61,"i",41),o(62," Add New Tag "),r()(),a(63,"div",7)(64,"form",8),u("ngSubmit",function(){return t.onTag()}),a(65,"div",9)(66,"label",42),o(67,"Tag Name"),r(),d(68,"input",43),r(),a(69,"div",35)(70,"button",44),d(71,"i",45),o(72,"Create Tag "),r()()()()(),a(73,"div",3)(74,"div",46)(75,"h3",5),d(76,"i",41),o(77," update Tag "),r()(),a(78,"div",7)(79,"form",8),u("ngSubmit",function(){return t.onupdateTag()}),a(80,"div",9)(81,"label",42),o(82,"Tag Name"),r(),d(83,"input",43),r(),a(84,"ul",47)(85,"button",48),d(86,"i",49),o(87,` Update Tag
`),r(),T(88,H,7,1,"li",50),r()()()()()()()),i&2&&(l(7),f(" ",t.isEdit?"Update Product":"Add New Product"," "),l(2),m("formGroup",t.addProduct),l(31),m("ngForOf",t.allTags),l(5),m("disabled",!0)("selected",!0),l(2),P(t.allOffers),l(9),f(" ",t.isEdit?"Update Product":"Add Product"," "),l(8),m("formGroup",t.addTag),l(15),m("formGroup",t.updateTag),l(6),m("disabled",!t.selectedTagId||t.updateTag.invalid),l(3),m("ngForOf",t.allTags))},dependencies:[E,x,j,D,q,G,N,O,A,F,C,k,V],encapsulation:2})};export{M as Product};
