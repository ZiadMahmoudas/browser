import{a as $}from"./chunk-XDAAUHTY.js";import{a as L}from"./chunk-G5KA7DMQ.js";import{b as F}from"./chunk-KXU7AWJN.js";import{e as P}from"./chunk-C345KUIT.js";import{n as R}from"./chunk-XDVOVM47.js";import{i as k,j as V}from"./chunk-RDDNRQB3.js";import{Ab as o,Bb as s,Eb as u,Fb as b,Kb as _,Lb as m,Qa as h,Ta as a,Wb as d,Yb as f,Za as C,bc as w,cb as g,ha as l,ia as p,ic as I,kc as T,rb as x,sb as E,tb as y,ub as S,zb as r}from"./chunk-G3DW5CM7.js";var U=(i,e)=>e.cartId;function j(i,e){if(i&1&&(r(0,"div",16)(1,"p",24),d(2),o(),r(3,"p",17),d(4),o()()),i&2){let t=m().$implicit;a(2),f("",t.salary," EGP"),a(2),f("",t.priceAfterDiscount," EGP")}}function D(i,e){if(i&1&&(r(0,"p",17),d(1),o()),i&2){let t=m().$implicit;a(),f("",t.priceAfterDiscount," EGP")}}function G(i,e){if(i&1){let t=u();r(0,"button",19)(1,"i",25),_("click",function(){l(t);let n=m().$implicit,v=m();return p(v.RemoveWishList(n.cartId))}),o()()}}function N(i,e){if(i&1){let t=u();r(0,"button",19)(1,"i",26),_("click",function(){l(t);let n=m().$implicit,v=m();return p(v.RemoveWishList(n.cartId))}),o()()}}function B(i,e){if(i&1){let t=u();r(0,"div",6)(1,"div",11)(2,"div",12),s(3,"img",13),o(),r(4,"div",14)(5,"h5",15),d(6),o(),x(7,j,5,2,"div",16)(8,D,2,1,"p",17),r(9,"div",18),x(10,G,2,0,"button",19)(11,N,2,0,"button",19),s(12,"input",20),r(13,"button",21),_("click",function(){let n=l(t).$implicit,v=m();return p(v.addItem(n.productId,1))}),s(14,"i",22),o()(),s(15,"div",23),o()()()}if(i&2){let t=e.$implicit;a(3),b("src",w("https://localhost:7054",t.images),h),a(3),f("Name:",t.productName),a(),E(t.offer?7:8),a(3),E(t.quantity>1?10:11),a(2),b("value",t.quantity)}}function M(i,e){if(i&1){let t=u();r(0,"button",27),_("click",function(){l(t);let n=m();return p(n.add())}),s(1,"i",28),d(2," Add Item "),o()}}function W(i,e){if(i&1){let t=u();r(0,"button",27),_("click",function(){l(t);let n=m();return p(n.goToShop())}),s(1,"i",29),d(2," buy in Shop "),o()}}var A=class i{constructor(e,t,c,n){this.router=e;this.auth=t;this.CartService=c;this.tostar=n}currentUserId=0;ngOnInit(){let e="http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier",t=this.auth.getAccessToken(),c=L(t);this.currentUserId=+c[e],this.loadItem(),this.CartService.totalPrice$.subscribe(n=>{this.totalPrice=n})}loadItem(){this.CartService.loadCart(this.currentUserId).subscribe({next:e=>this.items=e,error:e=>console.error("Failed to load cart",e)})}add(){this.router.navigateByUrl("Order")}items=[];totalPrice=0;RemoveWishList(e){this.CartService.removeFromCart(e).subscribe({next:t=>{console.log("Response from server:",t),this.tostar.success("\u062A\u0645 \u0627\u0644\u062D\u0630\u0641 \u0623\u0648 \u062A\u0642\u0644\u064A\u0644 \u0627\u0644\u0643\u0645\u064A\u0629 \u0628\u0646\u062C\u0627\u062D")},error:()=>{this.tostar.error("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0644\u062D\u0630\u0641")}})}addItem(e,t){this.CartService.addToCart(this.currentUserId,e,t).subscribe({next:()=>{this.tostar.success("\u062A\u0645 \u0627\u0644\u0627\u0636\u0627\u0641\u0629 \u0628\u0646\u062C\u0627\u062D")},error:()=>{this.tostar.error("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0644\u0627\u0636\u0627\u0641\u0629")}})}goToShop(){this.router.navigateByUrl("/Home")}static \u0275fac=function(t){return new(t||i)(C(P),C(F),C($),C(R))};static \u0275cmp=g({type:i,selectors:[["app-cart"]],decls:17,vars:6,consts:[[1,"container","my-5","pt-5"],[1,"row","mb-4"],[1,"col-12","text-center"],[1,"display-5","fw-bold","text-primary"],[1,"lead","text-muted"],[1,"row","row-cols-1","row-cols-sm-2","row-cols-md-2","row-cols-lg-3","g-4"],[1,"col"],[1,"d-flex","justify-content-center","align-items-center"],[1,"btn","btn-success","my-4"],[1,"bg-warning","p-2","text-white"],[1,"text-center","mt-3"],[1,"card","h-100","shadow-sm","border-0","rounded-3"],[1,"position-relative"],["alt","Product Image",1,"card-img-top","p-2","rounded-3",3,"src"],[1,"card-body","d-flex","flex-column"],[1,"card-title","fw-bold"],[1,"d-flex","gap-2"],[1,"product-price"],[1,"input-group","mb-3"],["type","button",1,"btn","btn-outline-secondary"],["type","text","readonly","",1,"form-control","text-center",3,"value"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"fas","fa-plus"],[1,"mt-auto","d-grid","gap-2"],[1,"product-price","text-decoration-line-through"],[1,"fas","fa-minus",3,"click"],[1,"fas","fa-trash-alt","me-2",3,"click"],[1,"btn","btn-success","my-4",3,"click"],[1,"fas","fa-plus","me-2"],[1,"fas","fa-shop","me-2"]],template:function(t,c){t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),d(4,"Your Shopping Cart"),o(),r(5,"p",4),d(6," Review and manage your items before checkout. "),o()()(),r(7,"div",5),y(8,B,16,6,"div",6,U),o(),r(10,"div",7),x(11,M,3,0,"button",8)(12,W,3,0,"button",8),o()(),r(13,"div",9)(14,"p",10),d(15),I(16,"currency"),o()()),t&2&&(a(8),S(c.items),a(3),E(c.items.length>0?11:12),a(4),f(" Total: ",T(16,2,c.totalPrice,"EGP","symbol")))},dependencies:[V,k],encapsulation:2})};export{A as Cart};
