import{a as Q}from"./chunk-DZRNPYBN.js";import{a as A,b as h,c as z,d as q,e as V,i as D,k as Y,l as j,r as L,s as G,u as B}from"./chunk-MHH2VTG2.js";import{b as N}from"./chunk-KXU7AWJN.js";import{b as S,e as T,f as I}from"./chunk-C345KUIT.js";import{n as $}from"./chunk-XDVOVM47.js";import"./chunk-RDDNRQB3.js";import{Eb as E,Jb as P,Lb as u,Qb as v,Rb as k,Sb as b,Ta as r,Ub as M,Wb as a,Xb as y,Za as p,cb as F,dc as R,ha as f,ia as w,pa as x,rb as d,sb as l,uc as O,vb as c,wb as i,xb as s,yb as m}from"./chunk-G3DW5CM7.js";var Z=["passwordInput"],U=["confirmPasswordField"],J=()=>["/login"];function K(o,n){o&1&&(i(0,"span"),a(1,"Password is required."),s())}function W(o,n){o&1&&(i(0,"span"),a(1,"Password must be at least 8 characters, with uppercase, lowercase, number, and special character."),s())}function X(o,n){if(o&1&&(i(0,"div",9),d(1,K,2,0,"span")(2,W,2,0,"span"),s()),o&2){let t=u();r(),l(t.newPassword.errors!=null&&t.newPassword.errors.required?1:t.newPassword.errors!=null&&t.newPassword.errors.pattern?2:-1)}}function ee(o,n){o&1&&(i(0,"span"),a(1,"Confirm Password is required."),s())}function te(o,n){if(o&1&&(i(0,"div",9),d(1,ee,2,0,"span"),s()),o&2){let t=u();r(),l(t.confirmPassword.errors!=null&&t.confirmPassword.errors.required?1:-1)}}function oe(o,n){o&1&&(i(0,"small",9),a(1,"Passwords do not match."),s())}function ne(o,n){o&1&&(i(0,"small",13),a(1,"Passwords match."),s())}function re(o,n){if(o&1&&(i(0,"div",14),a(1),s()),o&2){let t=u();r(),y(t.errorMessage)}}function ie(o,n){if(o&1&&(i(0,"div",15),a(1),s()),o&2){let t=u();r(),y(t.successMessage)}}function se(o,n){o&1&&(m(0,"span",21),i(1,"span",22),a(2,"Recovering..."),s())}function ae(o,n){o&1&&a(0," Recover Password ")}var H=class o{constructor(n,t,e,g,_){this.FB=n;this.route=t;this.auth=e;this.router=g;this.toastr=_;this.ForgetForm=this.FB.group({newPassword:["",[h.required,h.pattern(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_+])[A-Za-z\d!@#$%^&*()_+]{8,}$/)]],confirmPassword:["",h.required]},{validator:Q("newPassword","confirmPassword")})}isEyeOpen=x(!0);passwordInputRef=O("passwordInput");confirmPasswordField=O("confirmPasswordField");isConfirmPasswordEyeOpen=x(!0);loading=!1;errorMessage=null;successMessage=null;token=null;togglePasswordEye(n){this.isEyeOpen.update(t=>{let e=!t;return n.type=e?"text":"password",e})}toggleConfirmPasswordEye(n){this.isConfirmPasswordEyeOpen.update(t=>{let e=!t;return n.type=e?"text":"password",e})}ForgetForm=new V({});get confirmPassword(){return this.ForgetForm.controls.confirmPassword}get newPassword(){return this.ForgetForm.controls.newPassword}ngOnInit(){this.route.queryParams.subscribe(n=>{this.token=n.token}),setTimeout(()=>{this.passwordInputRef()&&this.togglePasswordEye(this.passwordInputRef().nativeElement),this.confirmPasswordField()&&this.toggleConfirmPasswordEye(this.confirmPasswordField().nativeElement)},0),this.ForgetForm.statusChanges.subscribe(n=>{this.ForgetForm.get("confirmPassword")?.touched&&!this.ForgetForm.hasError("passwordMismatch")?(this.successMatch=!0,setTimeout(()=>{this.successMatch=!1},3e3)):this.successMatch=!1})}onsubmit(){if(this.ForgetForm.invalid){this.ForgetForm.markAllAsTouched(),this.toastr.warning("Please Enter All Fields","Not Get AnyThing \u{1F608}"),this.errorMessage="Please fix the errors in the form.";return}if(!this.token){this.toastr.error("Password reset token is missing. Please request a new link.");return}this.loading=!0;let n={token:this.token,newPassword:this.ForgetForm.value.newPassword,confirmPassword:this.ForgetForm.value.confirmPassword};this.auth.submitNewPassword(n).subscribe({next:t=>{this.toastr.success("Password updated successfully! You can check your email to get password"),setTimeout(()=>{this.router.navigate(["/login"])},4e3),this.loading=!1},error:t=>{this.loading=!1,t.error&&t.error.message?this.errorMessage=t.error.message:t.status===400?this.toastr.error("Invalid or expired password reset token. Please request a new one."):t.status===401?this.toastr.error("Unauthorized: Please check your token."):this.toastr.error("An unexpected error occurred. Please try again.")}})}successMatch=!1;static \u0275fac=function(t){return new(t||o)(p(G),p(S),p(N),p(T),p($))};static \u0275cmp=F({type:o,selectors:[["app-reset-password"]],viewQuery:function(t,e){t&1&&(v(e.passwordInputRef,Z,5),v(e.confirmPasswordField,U,5)),t&2&&k(2)},decls:32,vars:22,consts:[["passwordInput",""],["confirmPasswordField",""],[1,"fullScreen","mb-5"],[1,"signup-container"],[3,"ngSubmit","formGroup"],[1,"input-group","password-toggle"],["for","password"],["formControlName","newPassword","id","password","name","password","placeholder","Please Enter Your new password","required","",3,"type"],[1,"fa-duotone","fa-light","fa-eye","toggle-password",3,"click"],[1,"text-danger"],["for","confirm-password"],["formControlName","confirmPassword","id","confirm-password","name","confirm-password","placeholder","Confirm New Password","required","",3,"type"],[1,"fa-duotone","fa-light","toggle-password",3,"click"],[1,"text-success"],[1,"alert","alert-danger","mt-3"],[1,"alert","alert-success","mt-3"],[1,"btn","btn-primary",3,"disabled"],[1,"d-flex","align-items-center","gap-1","mt-3",3,"routerLink"],[1,"fa-solid","fa-arrow-left"],[1,"social-signup"],[1,"social-button","justify-content-center","mb-3","mt-3",3,"routerLink"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],[1,"ms-2"]],template:function(t,e){if(t&1){let g=E();i(0,"div",2)(1,"div",3)(2,"h2"),a(3,"Recover Your Password"),s(),i(4,"form",4),P("ngSubmit",function(){return f(g),w(e.onsubmit())}),i(5,"div",5)(6,"label",6),a(7,"New Password"),s(),m(8,"input",7,0),i(10,"i",8),P("click",function(){f(g);let C=b(9);return w(e.togglePasswordEye(C))}),s()(),d(11,X,3,1,"div",9),i(12,"div",5)(13,"label",10),a(14,"Confirm New Password"),s(),m(15,"input",11,1),i(17,"i",12),P("click",function(){f(g);let C=b(16);return w(e.toggleConfirmPasswordEye(C))}),s()(),d(18,te,2,1,"div",9),d(19,oe,2,0,"small",9),d(20,ne,2,0,"small",13),d(21,re,2,1,"div",14),d(22,ie,2,1,"div",15),i(23,"button",16),d(24,se,3,0)(25,ae,1,0),s()(),i(26,"a",17),m(27,"i",18),a(28," Back to Forget Password "),s(),i(29,"div",19)(30,"a",20),a(31," Login "),s()()()()}t&2&&(r(4),c("formGroup",e.ForgetForm),r(4),c("type",e.isEyeOpen()?"text":"password"),r(2),M("fa-eye",e.isEyeOpen())("fa-eye-slash",!e.isEyeOpen()),r(),l(e.newPassword.invalid&&e.newPassword.touched?11:-1),r(4),c("type",e.isConfirmPasswordEyeOpen()?"text":"password"),r(2),M("fa-eye",e.isConfirmPasswordEyeOpen())("fa-eye-slash",!e.isConfirmPasswordEyeOpen()),r(),l(e.confirmPassword.invalid&&e.confirmPassword.touched?18:-1),r(),l(e.ForgetForm.hasError("passwordMismatch")&&e.ForgetForm.touched?19:-1),r(),l(e.successMatch&&!e.ForgetForm.hasError("passwordMismatch")&&e.ForgetForm.touched?20:-1),r(),l(e.errorMessage?21:-1),r(),l(e.successMessage?22:-1),r(),c("disabled",e.loading||e.ForgetForm.invalid),r(),l(e.loading?24:25),r(2),c("routerLink","/forgetPassword"),r(4),c("routerLink",R(21,J)))},dependencies:[B,D,A,z,q,L,Y,j,I],styles:['.fullScreen[_ngcontent-%COMP%]{font-family:Cairo,sans-serif;background:linear-gradient(to right,#6a11cb,#2575fc);display:flex;justify-content:center;align-items:center;min-height:100vh;margin:0;color:#333}.password-toggle[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:calc(100% - 20px);padding:12px 40px 12px 10px;border:1px solid #ddd;border-radius:8px;font-size:1em;transition:border-color .3s ease,box-shadow .3s ease;box-sizing:border-box}.password-toggle[_ngcontent-%COMP%]   .toggle-password[_ngcontent-%COMP%]{position:absolute;top:71%;right:32px;transform:translateY(-71%);cursor:pointer;color:#aaa;font-size:1.1em;transition:color .3s ease}.password-toggle[_ngcontent-%COMP%]   .toggle-password[_ngcontent-%COMP%]:hover{color:#666}.signup-container[_ngcontent-%COMP%]{background-color:#fff;padding:40px;border-radius:15px;box-shadow:0 10px 30px #0003;width:100%;max-width:450px;text-align:center;animation:_ngcontent-%COMP%_fadeIn .8s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}h2[_ngcontent-%COMP%]{color:#333;margin-bottom:25px;font-size:2em;position:relative}h2[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-10px;left:50%;transform:translate(-50%);width:60px;height:4px;background-color:#2575fc;border-radius:2px}.input-group[_ngcontent-%COMP%]{margin-bottom:20px;text-align:right}.input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:8px;font-weight:600;color:#555;font-size:.95em}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:calc(100% - 20px);padding:12px 10px;border:1px solid #ddd;border-radius:8px;font-size:1em;transition:border-color .3s ease,box-shadow .3s ease}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#2575fc;box-shadow:0 0 0 3px #2575fc33;outline:none}.input-group[_ngcontent-%COMP%]   input.error[_ngcontent-%COMP%]{border-color:red;box-shadow:0 0 0 3px #d6040433;outline:none}.input-group[_ngcontent-%COMP%]   input.success[_ngcontent-%COMP%]{border-color:#0f0;box-shadow:0 0 0 3px #03e21533;outline:none}.password-toggle[_ngcontent-%COMP%]{position:relative}.password-toggle[_ngcontent-%COMP%]   .toggle-icon[_ngcontent-%COMP%]{position:absolute;left:10px;top:50%;transform:translateY(-50%);cursor:pointer;color:#aaa;font-size:1.1em;transition:color .3s ease}.password-toggle[_ngcontent-%COMP%]   .toggle-icon[_ngcontent-%COMP%]:hover{color:#666}button[_ngcontent-%COMP%]{background-color:#2575fc;color:#fff;padding:15px 30px;border:none;border-radius:8px;font-size:1.1em;font-weight:600;cursor:pointer;transition:background-color .3s ease,transform .2s ease;width:100%;margin-top:20px}button[_ngcontent-%COMP%]:hover{background-color:#1a5acb;transform:translateY(-2px)}.social-signup[_ngcontent-%COMP%]{margin-top:25px;border-top:1px solid #eee;padding-top:25px}.social-signup[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;margin-bottom:15px;font-size:.9em}.social-buttons[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:15px}.social-button[_ngcontent-%COMP%]{background-color:#f4f4f4;border:1px solid #ddd;padding:12px 20px;border-radius:8px;cursor:pointer;transition:background-color .3s ease,transform .2s ease;display:flex;align-items:center;gap:8px;font-size:.9em;color:#444;text-decoration:none}.social-button[_ngcontent-%COMP%]:hover{background-color:#e9e9e9;transform:translateY(-2px)}.social-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px;height:20px}.login-link[_ngcontent-%COMP%]{margin-top:25px;font-size:.9em;color:#666}.login-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#2575fc;text-decoration:none;font-weight:600;transition:color .3s ease}.login-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#1a5acb;text-decoration:underline}']})};export{H as ResetPassword};
