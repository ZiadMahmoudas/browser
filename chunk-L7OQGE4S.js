import{a as ue,b as he}from"./chunk-XNEI3QR4.js";import{a as te,b as E,c as ie,d as oe,e as ne,i as re,k as se,l as ae,r as ce,s as le,u as de}from"./chunk-MHH2VTG2.js";import{a as ge}from"./chunk-JUKI7UPX.js";import{a as me}from"./chunk-XDAAUHTY.js";import{a as j}from"./chunk-G5KA7DMQ.js";import{a as ee,b as T}from"./chunk-KXU7AWJN.js";import{e as $,f as J}from"./chunk-C345KUIT.js";import{n as pe}from"./chunk-XDVOVM47.js";import{j as Z,k as X}from"./chunk-RDDNRQB3.js";import{$ as h,D as z,Eb as q,Jb as m,Lb as U,Qb as H,Rb as K,Sb as W,Ta as p,Ub as S,Wb as d,Y as B,Z as P,Za as a,a as F,aa as g,b as A,cb as C,db as M,dc as Y,ha as v,ia as b,jb as k,kb as N,l as R,p as L,pa as D,qb as G,rb as O,sb as I,uc as Q,va as w,vb as _,wb as c,xb as l,yb as x,za as V}from"./chunk-G3DW5CM7.js";var Ce=new h("recaptcha-language"),ke=new h("recaptcha-base-url"),_e=new h("recaptcha-nonce-tag"),Se=new h("recaptcha-settings"),Ee=new h("recaptcha-v3-site-key"),Pe=new h("recaptcha-loader-options");function Me(n,e,o,{url:t,lang:i,nonce:r}={}){window.ng2recaptchaloaded=()=>{o(grecaptcha)};let s=document.createElement("script");s.innerHTML="";let{url:u,nonce:y}=e(new URL(t||"https://www.google.com/recaptcha/api.js"));u.searchParams.set("render",n==="explicit"?n:n.key),u.searchParams.set("onload","ng2recaptchaloaded"),u.searchParams.set("trustedtypes","true"),i&&u.searchParams.set("hl",i),s.src=u.href;let f=y||r;f&&s.setAttribute("nonce",f),s.async=!0,s.defer=!0,document.head.appendChild(s)}function Oe({v3SiteKey:n,onBeforeLoad:e,onLoaded:o}){let t=n?{key:n}:"explicit";fe.loadScript(t,e,o)}var fe={loadScript:Me,newLoadScript:Oe};function Ie(n){return n.asObservable().pipe(z(e=>e!==null))}var ve=(()=>{let e=class e{constructor(t,i,r,s,u,y){this.platformId=t,this.language=i,this.baseUrl=r,this.nonce=s,this.v3SiteKey=u,this.options=y;let f=this.init();this.ready=f?Ie(f):L()}init(){if(e.ready)return e.ready;if(!X(this.platformId))return;let t=new R(null);return e.ready=t,fe.newLoadScript({v3SiteKey:this.v3SiteKey,onBeforeLoad:i=>{if(this.options?.onBeforeLoad)return this.options.onBeforeLoad(i);let r=new URL(this.baseUrl??i);return this.language&&r.searchParams.set("hl",this.language),{url:r,nonce:this.nonce}},onLoaded:i=>{let r=i;this.options?.onLoaded&&(r=this.options.onLoaded(i)),t.next(r)}}),t}};e.ready=null,e.\u0275fac=function(i){return new(i||e)(g(V),g(Ce,8),g(ke,8),g(_e,8),g(Ee,8),g(Pe,8))},e.\u0275prov=B({token:e,factory:e.\u0275fac});let n=e;return n})(),Te=0,be=(()=>{let e=class e{constructor(t,i,r,s){this.elementRef=t,this.loader=i,this.zone=r,this.id=`ngrecaptcha-${Te++}`,this.errorMode="default",this.resolved=new k,this.error=new k,this.errored=new k,s&&(this.siteKey=s.siteKey,this.theme=s.theme,this.type=s.type,this.size=s.size,this.badge=s.badge)}ngAfterViewInit(){this.subscription=this.loader.ready.subscribe(t=>{t!=null&&t.render instanceof Function&&(this.grecaptcha=t,this.renderRecaptcha())})}ngOnDestroy(){this.grecaptchaReset(),this.subscription&&this.subscription.unsubscribe()}execute(){this.size==="invisible"&&(this.widget!=null?this.grecaptcha.execute(this.widget):this.executeRequested=!0)}reset(){this.widget!=null&&(this.grecaptcha.getResponse(this.widget)&&this.resolved.emit(null),this.grecaptchaReset())}get __unsafe_widgetValue(){return this.widget!=null?this.grecaptcha.getResponse(this.widget):null}expired(){this.resolved.emit(null)}onError(t){this.error.emit(t),this.errored.emit(t)}captchaResponseCallback(t){this.resolved.emit(t)}grecaptchaReset(){this.widget!=null&&this.zone.runOutsideAngular(()=>this.grecaptcha.reset(this.widget))}renderRecaptcha(){let t={badge:this.badge,callback:i=>{this.zone.run(()=>this.captchaResponseCallback(i))},"expired-callback":()=>{this.zone.run(()=>this.expired())},sitekey:this.siteKey,size:this.size,tabindex:this.tabIndex,theme:this.theme,type:this.type};this.errorMode==="handled"&&(t["error-callback"]=(...i)=>{this.zone.run(()=>this.onError(i))}),this.widget=this.grecaptcha.render(this.elementRef.nativeElement,t),this.executeRequested===!0&&(this.executeRequested=!1,this.execute())}};e.\u0275fac=function(i){return new(i||e)(a(w),a(ve),a(N),a(Se,8))},e.\u0275cmp=C({type:e,selectors:[["re-captcha"]],hostVars:1,hostBindings:function(i,r){i&2&&G("id",r.id)},inputs:{id:"id",siteKey:"siteKey",theme:"theme",type:"type",size:"size",tabIndex:"tabIndex",badge:"badge",errorMode:"errorMode"},outputs:{resolved:"resolved",error:"error",errored:"errored"},exportAs:["reCaptcha"],standalone:!1,decls:0,vars:0,template:function(i,r){},encapsulation:2});let n=e;return n})(),je=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=M({type:e}),e.\u0275inj=P({});let n=e;return n})(),we=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=M({type:e}),e.\u0275inj=P({providers:[ve],imports:[je]});let n=e;return n})();var Ae=["passwordInput"],Re=()=>["/signup"];function Le(n,e){n&1&&(c(0,"small",23),d(1,"Please Follow This Pattern above Two Character"),l())}function ze(n,e){if(n&1&&O(0,Le,2,0,"small",23),n&2){let o=U();I(o.email.errors!=null&&o.email.errors.pattern?0:-1)}}var xe=class n{constructor(e,o,t,i,r,s,u,y,f){this.FB=e;this.auth=o;this.authService=t;this.toastr=i;this.router=r;this.metaService=s;this.TokenService=u;this.items=y;this.CartService=f;this.loginForm=this.FB.group({email:["",[E.required,E.pattern(/[a-z]{2,}/i)]],password:["",[E.required]]})}isEyeOpen=D(!0);passwordInputRef=Q("passwordInput",{read:w});togglePasswordEye(e){this.isEyeOpen.update(o=>{let t=!o;return e.type=t?"text":"password",t})}currentUserId=0;ngOnInit(){this.metaService.setMeta(),this.togglePasswordEye(this.passwordInputRef);let e="http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier",o=this.auth.getAccessToken(),i=+j(o)[e];this.currentUserId=i}loginForm=new ne("");get email(){return this.loginForm.controls.email}get password(){return this.loginForm.controls.password}recaptchaToken=null;invalidLogin=!1;onsubmit(){if(this.loginForm.invalid||!this.recaptchaToken){ue.ValidateAllFormFields(this.loginForm),this.toastr.warning("Please fill in all fields and complete the captcha","Validation Error");return}let e=A(F({},this.loginForm.value),{recaptchaToken:this.recaptchaToken});this.auth.login(e).subscribe({next:o=>{this.auth.saveNewTokens(o);let r=+j(o.accessToken)["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"];this.items.setCurrentUserId(r),this.CartService.loadCartFromServer(r).subscribe(),this.items.fetchAndStoreWishlist(r).subscribe({next:()=>{this.router.navigate(["/Home"])},error:()=>{this.toastr.error("Failed to load wishlist after login")}})},error:()=>{this.invalidLogin=!0,this.toastr.error("Login failed","Please try again")}})}onCaptchaResolved(e){this.recaptchaToken=e}isInvalid(e){let o=this.loginForm.get(e);return!o||this.invalidLogin&&o.dirty&&!o.invalid?!1:o.invalid&&(o.dirty||o.touched)||this.invalidLogin}isValid(e){let o=this.loginForm.get(e);return o?o.valid&&(o.dirty||o.touched)&&!this.invalidLogin:!1}ngAfterViewInit(){this.loginWithGoogle()}loginWithGoogle(){google.accounts.id.initialize({client_id:"799712541569-lm1a9m98asgu88jeiumkq4l9s1l3lo8h.apps.googleusercontent.com",callback:e=>this.handleCredentialResponse(e)}),google.accounts.id.renderButton(document.getElementById("login-button"),{theme:"outline",size:"large"})}handleCredentialResponse(e){let o=e.credential;if(!this.recaptchaToken){this.toastr.error("Please complete the captcha before using Google login");return}let t={idToken:o,recaptchaToken:this.recaptchaToken,provider:"Google"};this.authService.loginWithGoogle(t.idToken,t.recaptchaToken).subscribe({next:i=>{this.toastr.success("Logged in with Google"),this.TokenService.setAccessToken(i.accessToken),this.router.navigateByUrl("/Home")},error:i=>{console.error("Google login error:",i),this.toastr.error("Google login failed")}})}loginWithFacebook(){if(!this.recaptchaToken){this.toastr.error("Please complete the captcha before using Facebook login");return}FB.login(e=>{if(e.authResponse){let o=e.authResponse.accessToken;this.authService.loginWithFacebook(o,this.recaptchaToken).subscribe({next:t=>{this.toastr.success("Logged in with Facebook"),this.TokenService.setAccessToken(t.accessToken),this.router.navigateByUrl("/Home")},error:t=>{console.error("Facebook login error:",t),this.toastr.error("Facebook login failed")}})}else console.warn("User cancelled Facebook login or did not authorize.")},{scope:"email,public_profile"})}static \u0275fac=function(o){return new(o||n)(a(le),a(T),a(T),a(pe),a($),a(he),a(ee),a(ge),a(me))};static \u0275cmp=C({type:n,selectors:[["app-login"]],viewQuery:function(o,t){o&1&&H(t.passwordInputRef,Ae,5,w),o&2&&K()},decls:33,vars:17,consts:[["passwordInput",""],[1,"fullScreen"],[1,"signup-container"],[3,"ngSubmit","formGroup"],[1,"input-group"],["for","email"],["formControlName","email","type","text","id","email","name","Email","placeholder","Please Enter Your Email","required",""],[1,"input-group","password-toggle"],["for","Password"],["formControlName","password","type","password","id","password","name","password","placeholder","Please Enter Your password","required",""],[1,"fa-duotone","fa-light","fa-eye","toggle-password",3,"click"],["type","submit",3,"disabled"],[1,"my-3","d-flex","justify-content-center"],["siteKey","6Ldv_qMrAAAAAD3IX6fx1hlGz5zju-qplVaxv9c2",3,"resolved"],[1,"text-end","my-3"],["routerLink","/forgetPassword"],[1,"social-signup"],[1,"social-button","mb-3","justify-content-center",3,"routerLink"],[1,"social-buttons"],[1,"social-button",3,"click"],["src","https://upload.wikimedia.org/wikipedia/commons/thumb/c/cd/Facebook_logo_%28square%29.png/640px-Facebook_logo_%28square%29.png","alt","Facebook"],["id","login-button","type","button",1,"social-button",3,"click"],["src","https://upload.wikimedia.org/wikipedia/commons/thumb/c/c1/Google_%22G%22_logo.svg/768px-Google_%22G%22_logo.svg.png","alt","Google"],[1,"error-message"]],template:function(o,t){if(o&1){let i=q();c(0,"div",1)(1,"div",2)(2,"h2"),d(3,"Login"),l(),c(4,"form",3),m("ngSubmit",function(){return v(i),b(t.onsubmit())}),c(5,"div",4)(6,"label",5),d(7,"Email"),l(),x(8,"input",6),l(),O(9,ze,1,1),c(10,"div",7)(11,"label",8),d(12," password "),l(),x(13,"input",9,0),c(15,"i",10),m("click",function(){v(i);let s=W(14);return b(t.togglePasswordEye(s))}),l()(),c(16,"button",11),d(17,"^login^"),l()(),c(18,"div",12)(19,"re-captcha",13),m("resolved",function(s){return v(i),b(t.onCaptchaResolved(s))}),l()(),c(20,"div",14)(21,"a",15),d(22,"Forget Password"),l()(),c(23,"div",16)(24,"a",17),d(25," Signup "),l(),c(26,"div",18)(27,"button",19),m("click",function(){return v(i),b(t.loginWithFacebook())}),x(28,"img",20),d(29," Facebook "),l(),c(30,"button",21),m("click",function(){return v(i),b(t.loginWithGoogle())}),x(31,"img",22),d(32," Google "),l()()()()()}o&2&&(p(4),_("formGroup",t.loginForm),p(4),S("error",t.isInvalid("email"))("success",t.isValid("email")),p(),I(t.email.invalid&&t.email.touched?9:-1),p(4),S("error",t.isInvalid("password"))("success",t.isValid("password")),p(2),S("fa-eye",t.isEyeOpen())("fa-eye-slash",!t.isEyeOpen()),p(),_("disabled",t.loginForm.invalid||!t.recaptchaToken),p(8),_("routerLink",Y(16,Re)))},dependencies:[J,de,re,te,ie,oe,ce,se,ae,Z,we,be],styles:['.fullScreen[_ngcontent-%COMP%]{font-family:Cairo,sans-serif;background:linear-gradient(to right,#6a11cb,#2575fc);display:flex;justify-content:center;align-items:center;min-height:100vh;margin:0;color:#333}.signup-container[_ngcontent-%COMP%]{background-color:#fff;padding:40px;border-radius:15px;box-shadow:0 10px 30px #0003;width:100%;max-width:450px;text-align:center;animation:_ngcontent-%COMP%_fadeIn .8s ease-out;margin-top:64px}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}h2[_ngcontent-%COMP%]{color:#333;margin-bottom:25px;font-size:2em;position:relative}h2[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-10px;left:50%;transform:translate(-50%);width:60px;height:4px;background-color:#2575fc;border-radius:2px}.input-group[_ngcontent-%COMP%]{margin-bottom:20px;text-align:right}.input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:8px;font-weight:600;color:#555;font-size:.95em}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:calc(100% - 20px);padding:12px 10px;border:1px solid #ddd;border-radius:8px;font-size:1em;transition:border-color .3s ease,box-shadow .3s ease}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#2575fc;box-shadow:0 0 0 3px #2575fc33;outline:none}.password-toggle[_ngcontent-%COMP%]{position:relative}.password-toggle[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:calc(100% - 20px);padding:12px 40px 12px 10px;border:1px solid #ddd;border-radius:8px;font-size:1em;transition:border-color .3s ease,box-shadow .3s ease;box-sizing:border-box}.password-toggle[_ngcontent-%COMP%]   .toggle-password[_ngcontent-%COMP%]{position:absolute;top:71%;right:32px;transform:translateY(-71%);cursor:pointer;color:#aaa;font-size:1.1em;transition:color .3s ease}.password-toggle[_ngcontent-%COMP%]   .toggle-password[_ngcontent-%COMP%]:hover{color:#666}.password-toggle[_ngcontent-%COMP%]   .toggle-icon[_ngcontent-%COMP%]{position:absolute;left:10px;top:50%;transform:translateY(-50%);cursor:pointer;color:#aaa;font-size:1.1em;transition:color .3s ease}.password-toggle[_ngcontent-%COMP%]   .toggle-icon[_ngcontent-%COMP%]:hover{color:#666}button[_ngcontent-%COMP%]{background-color:#2575fc;color:#fff;padding:15px 30px;border:none;border-radius:8px;font-size:1.1em;font-weight:600;cursor:pointer;transition:background-color .3s ease,transform .2s ease;width:100%;margin-top:20px}button[_ngcontent-%COMP%]:hover{background-color:#1a5acb;transform:translateY(-2px)}.social-signup[_ngcontent-%COMP%]{margin-top:25px;border-top:1px solid #eee;padding-top:25px}.social-signup[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;margin-bottom:15px;font-size:.9em}.social-buttons[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:15px}.social-button[_ngcontent-%COMP%]{background-color:#f4f4f4;border:1px solid #ddd;padding:12px 20px;border-radius:8px;cursor:pointer;transition:background-color .3s ease,transform .2s ease;display:flex;align-items:center;gap:8px;font-size:.9em;color:#444;text-decoration:none}.social-button[_ngcontent-%COMP%]:hover{background-color:#e9e9e9;transform:translateY(-2px)}.social-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px;height:20px}.login-link[_ngcontent-%COMP%]{margin-top:25px;font-size:.9em;color:#666}.login-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#2575fc;text-decoration:none;font-weight:600;transition:color .3s ease}.login-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#1a5acb;text-decoration:underline}.input-group[_ngcontent-%COMP%]   input.error[_ngcontent-%COMP%]{border-color:red;box-shadow:0 0 0 3px #d6010133;outline:none}.input-group[_ngcontent-%COMP%]   input.success[_ngcontent-%COMP%]{border-color:#0f0;box-shadow:0 0 0 3px #01d60133;outline:none}.error-message[_ngcontent-%COMP%]{color:red;font-size:.85em;margin-top:1px;text-align:right}']})};export{xe as Login};
